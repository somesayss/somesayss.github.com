{"version":3,"sources":["webpack:///js/bus/html/form/main.js","webpack:///webpack/bootstrap 9d698fd7aaeefe6649aa?5603***","webpack:///external \"jQuery\"?0cb8*","webpack:///external \"limit\"?1d95*","webpack:///./src/js/bus/html/form/main.js","webpack:///./src/js/modules/upload/index.js","webpack:///./src/js/modules/parseForm/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","jQuery","limit","$","Upload","on","element","document","getElementById","onprogress","e","log","submit","then","err","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","ParseForm","_ParseForm","config","this","_this","getPrototypeOf","apply","arguments","a","url","K","errParseEle","errSys","me","assign","state","window","FormData","XMLHttpRequest","ajaxSubmit","iframeSubmit","Promise","resolve","reject","AJAX","open","upload","total","toFixed","toNumber","val","onload","parseRespone","responseText","onerror","send","useFormData","iframe","createElement","name","getUid","style","display","body","appendChild","iframeBody","contentWindow","innerHTML","replace","removeHideArea","errMeg","response","JSON","parse","getValueInObject","content","div","isFormElement","nodeName"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,SAGAV,EAAA,KDMM,SAASI,EAAQD,EAASH,GAE/BI,EAAOD,QAAUH,EAAoB,KAI/B,CACA,CACA,CACA,CACA,CACA,CAED,SAASI,EAAQD,GEzDvBC,EAAAD,QAAAQ,QF+DM,SAASP,EAAQD,GG/DvBC,EAAAD,QAAAS,OHoEO,CAED,SAASR,EAAQD,EAASH,GItEhC,YAGA,IAAMa,GAAIb,EAAQ,GACZY,EAAQZ,EAAQ,GAChBc,EAASd,EAAQ,GAEvBa,GAAE,eAAeE,GAAG,QAAS,WAC5B,GAAID,IACHE,QAASC,SAASC,eAAe,QACjCC,WAFU,SAECC,GACVR,EAAMS,IAAKT,EAAM,KAAKQ,EAAG,KAAO,QAE/BE,SAASC,KAAK,SAACH,GACjBR,EAAMS,IAAID,IACR,SAACA,GACHR,EAAMY,IAAIJ,QJ+EN,SAAShB,EAAQD,EAASH,GK/FhC,YLuGC,SAASyB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMvB,GAAQ,IAAKuB,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOxB,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BuB,EAAPvB,EAElO,QAASyB,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GANje,GAAIW,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWX,WAAaW,EAAWX,aAAc,EAAOW,EAAWT,cAAe,EAAU,SAAWS,KAAYA,EAAWV,UAAW,GAAML,OAAOgB,eAAeL,EAAQI,EAAWE,IAAKF,IAAiB,MAAO,UAAUxB,EAAa2B,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBnB,EAAYQ,UAAWmB,GAAiBC,GAAaT,EAAiBnB,EAAa4B,GAAqB5B,MKlG3hBf,EAAQZ,EAAQ,GAChBwD,EAAYxD,EAAQ,IAEpBc,EL0GQ,SAAU2C,GKlGvB,QAAA3C,GAAY4C,GAAOjC,EAAAkC,KAAA7C,EAAA,IAAA8C,GAAA/B,EAAA8B,MAAA7C,EAAA8B,WAAAR,OAAAyB,eAAA/C,IAAAgD,MAAAH,KACTI,WADSH,GAPnBZ,OACCgB,EAAG,KACFC,IAAK,sBACL9C,WAAYP,EAAMsD,EAClBC,YAAa,oBACbC,OAAQ,aAIT,IAAIC,IAFc,OAGlBzD,GAAM0D,OAAOD,EAAGE,MAAOF,EAAGrB,MAAOU,GAHfE,ELsNlB,MAnHA5B,GAAUlB,EAAQ2C,GAoBlBZ,EAAa/B,IACZuC,IAAK,SACLd,MAAO,WKnHR,GAAI8B,GAAKV,IACT,OAAIa,QAAOC,UAAYD,OAAOE,eACtBL,EAAGM,aAEHN,EAAGO,kBLwHVvB,IAAK,aACLd,MAAO,WKrHR,GAAI8B,GAAKV,IACT,OAAO,IAAIkB,SAAQ,SAACC,EAASC,GAC5B,IAAKV,EAAGrD,QACP,MAAO+D,GAAOV,EAAGE,MAAMJ,YAExB,IAAII,GAAQF,EAAGE,MACXS,EAAO,GAAIN,eACfM,GAAKC,KAAK,OAAQV,EAAMN,KAExBe,EAAKE,OAAO/D,WAAa,SAASC,GACjC,GAAId,GAASc,EAAEd,OACX6E,EAAQ/D,EAAE+D,KACdZ,GAAMpD,WAAYP,EAAMN,EAAO6E,GAAOC,QAAQ,GAAGC,WAAWC,MAAOhF,EAAQ6E,IAG5EH,EAAKO,OAAS,SAASnE,GACtBiD,EAAGmB,aAAapE,EAAE2B,OAAO0C,aAAcX,EAASC,IAGjDC,EAAKU,QAAUX,EACfC,EAAKW,KAAMtB,EAAGuB,oBL0HdvC,IAAK,eACLd,MAAO,WKvHR,GAAI8B,GAAKV,IACT,OAAO,IAAIkB,SAAQ,SAACC,EAASC,GAC5B,GAAI/D,GAAUqD,EAAGrD,OACjB,KAAKA,EACJ,MAAO+D,GAAOV,EAAGE,MAAMJ,YAExB,IAAI0B,GAAS5E,SAAS6E,cAAc,SACpC9E,GAAQ+B,OAAS8C,EAAOE,KAAP,SAAuBnF,EAAMoF,SAC9CH,EAAOI,MAAMC,QAAU,OACvBjF,SAASkF,KAAKC,YAAYP,GAC1BA,EAAON,OAAS,WACfM,EAAON,OAAS,IAChB,IAAIc,GAAaR,EAAOS,cAAcrF,SAASkF,KAC3CV,EAAeY,EAAWE,UAAUC,QAAQ,SAAU,GAC1DnC,GAAGmB,aAAaC,EAAcX,EAASC,GACvCV,EAAGoC,eAAeZ,GAClB7E,EAAQ+B,OAAS,IAElB/B,EAAQM,cL4HR+B,IAAK,eACLd,MAAO,SK1HIkD,EAAcX,EAASC,GACnC,GAAIV,GAAKV,KACL+C,EAASrC,EAAGE,MAAMH,MACtB,IAAIqB,EACH,IACC,GAAIkB,GAAWC,KAAKC,MAAMpB,EACtB7E,GAAMkG,iBAAiBH,EAAU,eAAgB,EAChD/F,EAAMkG,iBAAiBH,EAAU,UAAW,aAC/C7B,EAAQ6B,EAASI,SAEjBhC,EAAQnE,EAAMkG,iBAAiBH,EAAU,UAAW,QAAUD,GAG/D3B,EAAQnE,EAAMkG,iBAAiBH,EAAU,QAAUD,GAEpD,MAAMtF,GACN2D,EAAO3D,OAGR2D,GAAO2B,ML8HPrD,IAAK,iBACLd,MAAO,SK5HMvB,GACd,GACIgG,GAAM/F,SAAS6E,cAAc,MACjCkB,GAAIZ,YAAYpF,GAChBgG,EAAIT,UAAY,GAChBS,EAAM,SLgIClG,GK9NY0C,EAkGrBpD,GAAOD,QAAUW,GLmIX,SAASV,EAAQD,EAASH,GM3OhC,YNmPC,SAASyB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhH,GAAIiB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWX,WAAaW,EAAWX,aAAc,EAAOW,EAAWT,cAAe,EAAU,SAAWS,KAAYA,EAAWV,UAAW,GAAML,OAAOgB,eAAeL,EAAQI,EAAWE,IAAKF,IAAiB,MAAO,UAAUxB,EAAa2B,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBnB,EAAYQ,UAAWmB,GAAiBC,GAAaT,EAAiBnB,EAAa4B,GAAqB5B,MM9O3hBf,EAAQZ,EAAQ,GAEhBwD,ENkPW,WM5OhB,QAAAA,GAAYE,GAAOjC,EAAAkC,KAAAH,GAAAG,KALnBX,OACChC,QAAS,MAIS2C,KAFnBY,SAEmBZ,KADnB3C,QAAU,IAET,IAAIqD,GAAKV,KACLY,EAAQF,EAAGE,KACf3D,GAAM0D,OAAOC,EAAOF,EAAGrB,MAAOU,GAC1BW,EAAG4C,kBACN5C,EAAGrD,QAAUuD,EAAMvD,SN4QpB,MAnBA6B,GAAaW,IACZH,IAAK,gBACLd,MAAO,WMvPR,GAAI8B,GAAKV,KACLY,EAAQF,EAAGE,MACXvD,EAAUuD,EAAMvD,OACpB,OAAOA,IAAgC,SAArBA,EAAQkG,YN2PzB7D,IAAK,cACLd,MAAO,WMzPR,GAAI8B,GAAKV,KACL3C,EAAUqD,EAAGrD,OACjB,IAAIA,GAAWwD,OAAOC,SACrB,MAAO,IAAIA,UAASzD,ON+PdwC,IM1PTpD,GAAOD,QAAUqD","file":"js/bus/html/form/main.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(10);\n\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ function(module, exports) {\n\n\tmodule.exports = jQuery;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\tmodule.exports = limit;\n\n/***/ },\n/* 9 */,\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 依赖\n\t\n\tvar $ = __webpack_require__(7);\n\tvar limit = __webpack_require__(8);\n\tvar Upload = __webpack_require__(11);\n\t\n\t$('#fileUpload').on('click', function () {\n\t\tnew Upload({\n\t\t\telement: document.getElementById('form'),\n\t\t\tonprogress: function onprogress(e) {\n\t\t\t\tlimit.log(limit['*'](e, 100) + '%');\n\t\t\t}\n\t\t}).submit().then(function (e) {\n\t\t\tlimit.log(e);\n\t\t}, function (e) {\n\t\t\tlimit.err(e);\n\t\t});\n\t});\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 依赖\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar limit = __webpack_require__(8);\n\tvar ParseForm = __webpack_require__(12);\n\t\n\tvar Upload = function (_ParseForm) {\n\t\t_inherits(Upload, _ParseForm);\n\t\n\t\tfunction Upload(config) {\n\t\t\t_classCallCheck(this, Upload);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Upload.__proto__ || Object.getPrototypeOf(Upload)).apply(this, arguments));\n\t\n\t\t\t_this.props = {\n\t\t\t\ta: 'a1',\n\t\t\t\turl: '/common/upload.json',\n\t\t\t\tonprogress: limit.K,\n\t\t\t\terrParseEle: '上传失败，未解析到element。',\n\t\t\t\terrSys: '上传失败，系统错误。'\n\t\t\t};\n\t\n\t\t\tvar me = _this;\n\t\t\tlimit.assign(me.state, me.props, config);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Upload, [{\n\t\t\tkey: 'submit',\n\t\t\tvalue: function submit() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (window.FormData && window.XMLHttpRequest) {\n\t\t\t\t\treturn me.ajaxSubmit();\n\t\t\t\t} else {\n\t\t\t\t\treturn me.iframeSubmit();\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'ajaxSubmit',\n\t\t\tvalue: function ajaxSubmit() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\tif (!me.element) {\n\t\t\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t\t\t};\n\t\t\t\t\tvar state = me.state;\n\t\t\t\t\tvar AJAX = new XMLHttpRequest();\n\t\t\t\t\tAJAX.open('POST', state.url);\n\t\t\t\t\t// 上传进度\n\t\t\t\t\tAJAX.upload.onprogress = function (e) {\n\t\t\t\t\t\tvar loaded = e.loaded;\n\t\t\t\t\t\tvar total = e.total;\n\t\t\t\t\t\tstate.onprogress(limit(loaded / total).toFixed(2).toNumber().val(), loaded, total);\n\t\t\t\t\t};\n\t\t\t\t\t// 结束\n\t\t\t\t\tAJAX.onload = function (e) {\n\t\t\t\t\t\tme.parseRespone(e.target.responseText, resolve, reject);\n\t\t\t\t\t};\n\t\t\t\t\t// 错误\n\t\t\t\t\tAJAX.onerror = reject;\n\t\t\t\t\tAJAX.send(me.useFormData());\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'iframeSubmit',\n\t\t\tvalue: function iframeSubmit() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\tvar element = me.element;\n\t\t\t\t\tif (!element) {\n\t\t\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t\t\t};\n\t\t\t\t\tvar iframe = document.createElement('iframe');\n\t\t\t\t\telement.target = iframe.name = 'upload' + limit.getUid();\n\t\t\t\t\tiframe.style.display = 'none';\n\t\t\t\t\tdocument.body.appendChild(iframe);\n\t\t\t\t\tiframe.onload = function () {\n\t\t\t\t\t\tiframe.onload = null;\n\t\t\t\t\t\tvar iframeBody = iframe.contentWindow.document.body;\n\t\t\t\t\t\tvar responseText = iframeBody.innerHTML.replace(/<.*?>/g, '');\n\t\t\t\t\t\tme.parseRespone(responseText, resolve, reject);\n\t\t\t\t\t\tme.removeHideArea(iframe);\n\t\t\t\t\t\telement.target = '';\n\t\t\t\t\t};\n\t\t\t\t\telement.submit();\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'parseRespone',\n\t\t\tvalue: function parseRespone(responseText, resolve, reject) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar errMeg = me.state.errSys;\n\t\t\t\tif (responseText) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar response = JSON.parse(responseText);\n\t\t\t\t\t\tif (limit.getValueInObject(response, 'hasError') === false) {\n\t\t\t\t\t\t\tif (limit.getValueInObject(response, 'content', 'isSuccess')) {\n\t\t\t\t\t\t\t\tresolve(response.content);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treject(limit.getValueInObject(response, 'content', 'msg') || errMeg);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject(limit.getValueInObject(response, 'msg') || errMeg);\n\t\t\t\t\t\t};\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treject(errMeg);\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'removeHideArea',\n\t\t\tvalue: function removeHideArea(element) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar div = document.createElement('div');\n\t\t\t\tdiv.appendChild(element);\n\t\t\t\tdiv.innerHTML = '';\n\t\t\t\tdiv = null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Upload;\n\t}(ParseForm);\n\t\n\tmodule.exports = Upload;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 依赖\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar limit = __webpack_require__(8);\n\t\n\tvar ParseForm = function () {\n\t\tfunction ParseForm(config) {\n\t\t\t_classCallCheck(this, ParseForm);\n\t\n\t\t\tthis.props = {\n\t\t\t\telement: null // 主要表单\n\t\t\t};\n\t\t\tthis.state = {};\n\t\t\tthis.element = null;\n\t\n\t\t\tvar me = this;\n\t\t\tvar state = me.state;\n\t\t\tlimit.assign(state, me.props, config);\n\t\t\tif (me.isFormElement()) {\n\t\t\t\tme.element = state.element;\n\t\t\t};\n\t\t}\n\t\n\t\t_createClass(ParseForm, [{\n\t\t\tkey: 'isFormElement',\n\t\t\tvalue: function isFormElement() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar element = state.element;\n\t\t\t\treturn element && element.nodeName === 'FORM';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'useFormData',\n\t\t\tvalue: function useFormData() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar element = me.element;\n\t\t\t\tif (element && window.FormData) {\n\t\t\t\t\treturn new FormData(element);\n\t\t\t\t};\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn ParseForm;\n\t}();\n\t\n\tmodule.exports = ParseForm;\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** js/bus/html/form/main.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9d698fd7aaeefe6649aa\n **/","module.exports = jQuery;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jQuery\"\n ** module id = 7\n ** module chunks = 2 3 9 11 12 15 17 19 20 25 27 32 33 35 36\n **/","module.exports = limit;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"limit\"\n ** module id = 8\n ** module chunks = 2 3 4 5 6 9 12 13 15 16 17 18 19 20 21 24 25 26 27 28 29 30 31 32 33 34 35 36\n **/","\"use strict\";\n\n// 依赖\nconst $ = require('$');\nconst limit = require('limit');\nconst Upload = require('modules/upload/index');\n\n$('#fileUpload').on('click', () => {\n\tnew Upload({\n\t\telement: document.getElementById('form'),\n\t\tonprogress(e){\n\t\t\tlimit.log( limit['*'](e, 100) + '%');\n\t\t}\n\t}).submit().then((e) => {\n\t\tlimit.log(e);\n\t}, (e) => {\n\t\tlimit.err(e);\n\t});\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bus/html/form/main.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\nconst ParseForm = require('modules/parseForm/index');\n\nclass Upload extends ParseForm {\n\tprops = {\n\t\ta: 'a1'\n\t\t,url: '/common/upload.json'\n\t\t,onprogress: limit.K\n\t\t,errParseEle: '上传失败，未解析到element。'\n\t\t,errSys: '上传失败，系统错误。'\n\t}\n\tconstructor(config){\n\t\tsuper(...arguments);\n\t\tlet me = this;\n\t\tlimit.assign(me.state, me.props, config);\n\t}\n\tsubmit(){\n\t\tlet me = this;\n\t\tif( window.FormData && window.XMLHttpRequest ){\n\t\t\treturn me.ajaxSubmit();\n\t\t}else{\n\t\t\treturn me.iframeSubmit();\n\t\t};\n\t}\n\tajaxSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif( !me.element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet state = me.state;\n\t\t\tlet AJAX = new XMLHttpRequest();\n\t\t\tAJAX.open('POST', state.url);\n\t\t\t// 上传进度\n\t\t\tAJAX.upload.onprogress = function(e){\n\t\t\t\tlet loaded = e.loaded;\n\t\t\t\tlet total = e.total;\n\t\t\t\tstate.onprogress( limit(loaded/total).toFixed(2).toNumber().val(), loaded, total );\n\t\t\t};\n\t\t\t// 结束\n\t\t\tAJAX.onload = function(e){\n\t\t\t\tme.parseRespone(e.target.responseText, resolve, reject);\n\t\t\t};\n\t\t\t// 错误\n\t\t\tAJAX.onerror = reject;\n\t\t\tAJAX.send( me.useFormData() );\n\t\t});\n\t}\n\tiframeSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet element = me.element;\n\t\t\tif( !element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet iframe = document.createElement('iframe');\n\t\t\telement.target = iframe.name = `upload${limit.getUid()}`;\n\t\t\tiframe.style.display = 'none';\n\t\t\tdocument.body.appendChild(iframe);\n\t\t\tiframe.onload = function(){\n\t\t\t\tiframe.onload = null;\n\t\t\t\tlet iframeBody = iframe.contentWindow.document.body;\n\t\t\t\tlet responseText = iframeBody.innerHTML.replace(/<.*?>/g, '');\n\t\t\t\tme.parseRespone(responseText, resolve, reject);\n\t\t\t\tme.removeHideArea(iframe);\n\t\t\t\telement.target = '';\n\t\t\t};\n\t\t\telement.submit();\n\t\t});\n\t}\n\tparseRespone(responseText, resolve, reject){\n\t\tlet me = this;\n\t\tlet errMeg = me.state.errSys;\n\t\tif( responseText ){\n\t\t\ttry{\n\t\t\t\tlet response = JSON.parse(responseText);\n\t\t\t\tif( limit.getValueInObject(response, 'hasError') === false ){\n\t\t\t\t\tif( limit.getValueInObject(response, 'content', 'isSuccess') ){\n\t\t\t\t\t\tresolve(response.content);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject( limit.getValueInObject(response, 'content', 'msg') || errMeg );\n\t\t\t\t\t};\n\t\t\t\t}else{\n\t\t\t\t\treject( limit.getValueInObject(response, 'msg') || errMeg );\n\t\t\t\t};\n\t\t\t}catch(e){\n\t\t\t\treject(e);\n\t\t\t};\n\t\t}else{\n\t\t\treject(errMeg);\n\t\t};\n\t}\n\tremoveHideArea(element){\n\t\tlet me = this;\n\t\tlet div = document.createElement('div');\n\t\tdiv.appendChild(element);\n\t\tdiv.innerHTML = '';\n\t\tdiv = null;\n\t}\n}\n\nmodule.exports = Upload;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/upload/index.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\n\nclass ParseForm {\n\tprops = {\n\t\telement: null\t// 主要表单\n\t}\n\tstate = {}\n\telement = null\n\tconstructor(config){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlimit.assign(state, me.props, config);\n\t\tif( me.isFormElement() ){\n\t\t\tme.element = state.element;\n\t\t};\n\t}\n\tisFormElement(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet element = state.element;\n\t\treturn element && element.nodeName === 'FORM';\n\t}\n\tuseFormData(){\n\t\tlet me = this;\n\t\tlet element = me.element;\n\t\tif( element && window.FormData ){\n\t\t\treturn new FormData(element);\n\t\t};\n\t}\n}\n\nmodule.exports = ParseForm;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/parseForm/index.js\n **/"],"sourceRoot":""}