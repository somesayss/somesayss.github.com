{"version":3,"sources":["webpack:///webpack/bootstrap 2e8a12564fde4c987cbd?8a83****","webpack:///./src/js/common/domUtil.js?d828*","webpack:///external \"jQuery\"?0cb8*","webpack:///external \"limit\"?1d95*","webpack:///./src/js/bus/html/form/main.js","webpack:///./src/js/modules/upload/index.js?271f","webpack:///./src/js/modules/parseForm/index.js?3c9a"],"names":["domUtil","textSelect","input","start","end","setSelectionRange","focus","createTextRange","range","moveStart","moveEnd","collapse","select","DOC","document","isIE8","documentMode","isIEOld","defaultVal","iEOldVal","clearDom","node","clearDiv","createElement","appendChild","innerHTML","$","require","limit","Upload","on","element","getElementById","onprogress","e","log","submit","then","err","config","arguments","props","url","K","errParseEle","errSys","me","assign","state","window","FormData","XMLHttpRequest","ajaxSubmit","iframeSubmit","Promise","resolve","reject","AJAX","open","upload","loaded","total","toFixed","toNumber","val","onload","parseRespone","target","responseText","onerror","send","useFormData","iframe","name","getUid","action","style","display","body","off","iframeBody","contentWindow","replace","removeHideArea","errMeg","response","JSON","parse","getValueInObject","content","module","exports","ParseForm","isFormElement","nodeName"],"mappings":"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","file":"js/bus/html/form/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2e8a12564fde4c987cbd","\"use strict\";\r\n\r\nconst domUtil = {};\r\n\r\n// 选择input或者textarea\r\ndomUtil.textSelect = (input, start, end) => {\r\n\tif( input.setSelectionRange ){\r\n\t\tinput.setSelectionRange(start, end);\r\n\t\tinput.focus();\r\n\t}else if( input.createTextRange ){\r\n\t\tlet range = input.createTextRange();         \r\n\t\trange.moveStart(\"character\", start);\r\n\t\trange.moveEnd(\"character\",end);\r\n\t\tif( start === end ){\r\n\t\t\trange.collapse(true);\r\n\t\t};\r\n\t\trange.select();\r\n\t};\r\n};\r\n\r\nconst DOC = document;\r\n\r\nconst isIE8 = domUtil.isIE8 = () => {\r\n\treturn DOC.documentMode === 8;\r\n};\r\n\r\n// 是否是IE老的版本，现在定义的是IE8\r\ndomUtil.isIEOld = (defaultVal, iEOldVal) => {\r\n\tif( isIE8() ){\r\n\t\treturn iEOldVal;\r\n\t}else{\r\n\t\treturn defaultVal;\r\n\t};\r\n};\r\n\r\ndomUtil.clearDom = (node) => {\r\n\tlet clearDiv = document.createElement('div');\r\n\tclearDiv.appendChild(node);\r\n\tclearDiv.innerHTML = '';\r\n\tclearDiv = null;\r\n};\r\n\r\nexport default domUtil;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/common/domUtil.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 31\n// module chunks = 3 4 11 13 14 17 19 21 34 35 38","module.exports = limit;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"limit\"\n// module id = 32\n// module chunks = 3 4 5 11 14 15 17 18 19 21 22 27 29 33 34 35 36 37 38","\"use strict\";\n\n// 依赖\nconst $ = require('$');\nconst limit = require('limit');\nconst Upload = require('modules/upload/index');\n\n$('#fileUpload').on('click', () => {\n\tnew Upload({\n\t\telement: document.getElementById('form'),\n\t\tonprogress(e){\n\t\t\tlimit.log( limit['*'](e, 100) + '%');\n\t\t}\n\t}).submit().then((e) => {\n\t\tlimit.log(e);\n\t}, (e) => {\n\t\tlimit.err(e);\n\t});\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/bus/html/form/main.js","\"use strict\";\n\n// 依赖\nimport DomUtil from 'common/domUtil';\nimport ParseForm from 'modules/parseForm/index';\n\nclass Upload extends ParseForm {\n\tprops = {\n\t\turl: '/common/upload.json'\n\t\t,onprogress: limit.K\n\t\t,errParseEle: '上传失败，未解析到element。'\n\t\t,errSys: '上传失败，系统错误。'\n\t}\n\tconstructor(config){\n\t\tsuper(...arguments);\n\t\tlet me = this;\n\t\tlimit.assign(me.state, me.props, config);\n\t}\n\tsubmit(){\n\t\tlet me = this;\n\t\tif( window.FormData && window.XMLHttpRequest ){\n\t\t\treturn me.ajaxSubmit();\n\t\t}else{\n\t\t\treturn me.iframeSubmit();\n\t\t};\n\t}\n\tajaxSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif( !me.element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet state = me.state;\n\t\t\tlet AJAX = new XMLHttpRequest();\n\t\t\tAJAX.open('POST', state.url);\n\t\t\t// 上传进度\n\t\t\tAJAX.upload.onprogress = function(e){\n\t\t\t\tlet {loaded, total} = e;\n\t\t\t\tif( total ){\n\t\t\t\t\tstate.onprogress( limit(loaded/total).toFixed(2).toNumber().val(), loaded, total );\n\t\t\t\t};\n\t\t\t};\n\t\t\t// 结束\n\t\t\tAJAX.onload = function(e){\n\t\t\t\tme.parseRespone(e.target.responseText, resolve, reject);\n\t\t\t};\n\t\t\t// 错误\n\t\t\tAJAX.onerror = reject;\n\t\t\tAJAX.send( me.useFormData() );\n\t\t});\n\t}\n\tiframeSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet {state} = me;\n\t\t\tlet element = me.element;\n\t\t\tif( !element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet iframe = document.createElement('iframe');\n\t\t\telement.target = iframe.name = `upload${limit.getUid()}`;\n\t\t\telement.action = state.url;\n\t\t\tiframe.style.display = 'none';\n\t\t\tdocument.body.appendChild(iframe);\n\t\t\t$(iframe).on('load', () => {\n\t\t\t\t$(iframe).off('load');\n\t\t\t\tlet iframeBody = iframe.contentWindow.document.body;\n\t\t\t\tlet responseText = iframeBody.innerHTML.replace(/<.*?>/g, '');\n\t\t\t\tme.parseRespone(responseText, resolve, reject);\n\t\t\t\tme.removeHideArea(iframe);\n\t\t\t\telement.target = '';\n\t\t\t});\n\t\t\telement.submit();\n\t\t});\n\t}\n\tparseRespone(responseText, resolve, reject){\n\t\tlet me = this;\n\t\tlet errMeg = me.state.errSys;\n\t\tif( responseText ){\n\t\t\ttry{\n\t\t\t\tlet response = JSON.parse(responseText);\n\t\t\t\tif( limit.getValueInObject(response, 'hasError') === false ){\n\t\t\t\t\tif( limit.getValueInObject(response, 'content', 'isSuccess') ){\n\t\t\t\t\t\tresolve(response.content);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject( limit.getValueInObject(response, 'content', 'msg') || errMeg );\n\t\t\t\t\t};\n\t\t\t\t}else{\n\t\t\t\t\treject( limit.getValueInObject(response, 'msg') || errMeg );\n\t\t\t\t};\n\t\t\t}catch(e){\n\t\t\t\treject(e);\n\t\t\t};\n\t\t}else{\n\t\t\treject(errMeg);\n\t\t};\n\t}\n\tremoveHideArea(element){\n\t\tDomUtil.clearDom(element);\n\t}\n}\n\nmodule.exports = Upload;\n\n\n\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/upload/index.js","\"use strict\";\n\n// 依赖\nclass ParseForm {\n\tprops = {\n\t\telement: null\t// 主要表单\n\t}\n\tstate = {}\n\telement = null\n\tconstructor(config){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlimit.assign(state, me.props, config);\n\t\tif( me.isFormElement() ){\n\t\t\tme.element = state.element;\n\t\t};\n\t}\n\tisFormElement(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet element = state.element;\n\t\treturn element && element.nodeName === 'FORM';\n\t}\n\tuseFormData(){\n\t\tlet me = this;\n\t\tlet element = me.element;\n\t\tif( element && window.FormData ){\n\t\t\treturn new FormData(element);\n\t\t};\n\t}\n}\n\nexport default ParseForm;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/parseForm/index.js"],"sourceRoot":""}