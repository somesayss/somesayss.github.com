{"version":3,"sources":["webpack:///js/bus/html/media/main.js","webpack:///webpack/bootstrap 9d698fd7aaeefe6649aa?5603*****************","webpack:///external \"jQuery\"?0cb8******","webpack:///external \"limit\"?1d95**********","webpack:///./src/js/bus/html/media/main.js","webpack:///./src/js/modules/viewAudio/index.js","webpack:///./src/js/modules/audio/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","0","7","jQuery","8","limit","129","ViewAudio","viewCanvas","130","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","descriptor","defineProperty","key","protoProps","staticProps","Audio","viewAudio","_Audio","config","this","_this","getPrototypeOf","apply","arguments","_initialiseProps","me","assignSuper","state","initElement","stop","div","document","createElement","appendChild","canvas","innerHTML","initCanvas","getUserMediaArray","element","body","width","height","context","getContext","min","parseData","forEach","val","fillStyle","color","roundRect","concat","radius","x","y","w","h","r","max","Math","beginPath","moveTo","arcTo","closePath","fill","maxWidth","space","part","oneMaxWidth","floor","map","top","increase","changeArray","res","reduce","a","b","except","multiply","toFixed","drawCanvas","131","fftSize","K","stream","analyser","frameId","getArrayByAnalyser","cancelAnimationFrame","count","frequencyBinCount","array","Uint8Array","getByteFrequencyData","requestAnimationFrame","bind","getAudioContext","then","audioContext","media","createMediaStreamSource","createAnalyser","connect","Promise","resolve","reject","AudioContext","window","NAV","navigator","getMedia","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","audio","e","getUserMediaStream","getAnalyserByStream","err"],"mappings":"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","file":"js/bus/html/media/main.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(129);\n\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\tmodule.exports = jQuery;\n\n/***/ },\n\n/***/ 8:\n/***/ function(module, exports) {\n\n\tmodule.exports = limit;\n\n/***/ },\n\n/***/ 129:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 依赖\n\t\n\tvar $ = __webpack_require__(7);\n\tvar limit = __webpack_require__(8);\n\tvar ViewAudio = __webpack_require__(130);\n\t\n\tnew ViewAudio().viewCanvas();\n\n/***/ },\n\n/***/ 130:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 依赖\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar limit = __webpack_require__(8);\n\tvar Audio = __webpack_require__(131);\n\t\n\tvar viewAudio = function (_Audio) {\n\t\t_inherits(viewAudio, _Audio);\n\t\n\t\t//画布节点\n\t\tfunction viewAudio(config) {\n\t\t\t_classCallCheck(this, viewAudio);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (viewAudio.__proto__ || Object.getPrototypeOf(viewAudio)).apply(this, arguments));\n\t\n\t\t\t_initialiseProps.call(_this);\n\t\n\t\t\tvar me = _this;\n\t\t\tlimit.assignSuper(me.state, me.props, config);\n\t\t\tme.initElement();\n\t\t\treturn _this;\n\t\t} //画布\n\t\n\t\n\t\t_createClass(viewAudio, [{\n\t\t\tkey: 'destroy',\n\t\t\tvalue: function destroy() {\n\t\t\t\tvar me = this;\n\t\t\t\tme.stop();\n\t\t\t\tvar div = document.createElement('div');\n\t\t\t\tdiv.appendChild(me.canvas);\n\t\t\t\tdiv.innerHTML = '';\n\t\t\t\tdiv = null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'viewCanvas',\n\t\t\tvalue: function viewCanvas() {\n\t\t\t\tvar me = this;\n\t\t\t\tme.initCanvas();\n\t\t\t\tme.getUserMediaArray();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'initElement',\n\t\t\tvalue: function initElement() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tif (state.element) {\n\t\t\t\t\tme.element = state.element;\n\t\t\t\t} else {\n\t\t\t\t\tme.element = document.body;\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'initCanvas',\n\t\t\tvalue: function initCanvas() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar canvas = document.createElement('canvas');\n\t\t\t\tme.canvas = canvas;\n\t\t\t\tme.element.appendChild(canvas);\n\t\t\t\tcanvas.width = state.width;\n\t\t\t\tcanvas.height = state.height;\n\t\t\t\tme.context = canvas.getContext('2d');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'drawCanvas',\n\t\t\tvalue: function drawCanvas(min) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar context = me.context;\n\t\t\t\tme.parseData().forEach(function (val, key) {\n\t\t\t\t\tcontext.fillStyle = '#CCC';\n\t\t\t\t\tif (key < min) {\n\t\t\t\t\t\tcontext.fillStyle = state.color;\n\t\t\t\t\t};\n\t\t\t\t\tme.roundRect.apply(context, [].concat(_toConsumableArray(val), [state.radius]));\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'roundRect',\n\t\t\tvalue: function roundRect(x, y, w, h, r) {\n\t\t\t\tvar context = this;\n\t\t\t\tvar max = Math.min(w, h);\n\t\t\t\tif (r > max / 2) {\n\t\t\t\t\tr = max / 2;\n\t\t\t\t};\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(x + r, y);\n\t\t\t\tcontext.arcTo(x + w, y, x + w, y + h, r);\n\t\t\t\tcontext.arcTo(x + w, y + h, x, y + h, r);\n\t\t\t\tcontext.arcTo(x, y + h, x, y, r);\n\t\t\t\tcontext.arcTo(x, y, x + w, y, r);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.fill();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'parseData',\n\t\t\tvalue: function parseData() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar maxWidth = state.width - state.space * state.part;\n\t\t\t\tvar oneMaxWidth = Math.floor(maxWidth / state.part);\n\t\t\t\treturn limit.from(new Array(state.part)).map(function (val, key) {\n\t\t\t\t\tvar top = (oneMaxWidth + state.space) * key;\n\t\t\t\t\treturn [top, 0, oneMaxWidth, state.height];\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn viewAudio;\n\t}(Audio);\n\t// 0 20 \n\t\n\t\n\tvar _initialiseProps = function _initialiseProps() {\n\t\tthis.props = {\n\t\t\telement: null //置入的元素默认是body\n\t\t\t, width: 200 //宽\n\t\t\t, height: 40 //高\n\t\t\t, part: 10 //个数\n\t\t\t, space: 5 //间隔\n\t\t\t, radius: 4 //半角\n\t\t\t, increase: 0 //增强[0~50]\n\t\t\t, color: '#4d90fe' //颜色\n\t\t\t, changeArray: function changeArray(arr) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar length = arr.length;\n\t\t\t\tlength = length - length * state.increase / 100;\n\t\t\t\tvar res = arr.reduce(function (a, b) {\n\t\t\t\t\treturn a + b;\n\t\t\t\t}) / length;\n\t\t\t\tres = limit(res).except(256).multiply(10).toFixed().val();\n\t\t\t\tme.drawCanvas(res);\n\t\t\t}\n\t\t};\n\t\tthis.context = null;\n\t\tthis.canvas = null;\n\t};\n\t\n\tmodule.exports = viewAudio;\n\n/***/ },\n\n/***/ 131:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t// 参考 http://www.cnblogs.com/Wayou/p/3543577.html\n\t// https://mdn.github.io/voice-change-o-matic/\n\t\n\t// 依赖\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar limit = __webpack_require__(8);\n\t\n\tvar Audio = function () {\n\t\t//定时器ID\n\t\t//媒体流\n\t\tfunction Audio(config) {\n\t\t\t_classCallCheck(this, Audio);\n\t\n\t\t\tthis.props = {\n\t\t\t\tfftSize: 128,\n\t\t\t\tchangeArray: limit.K\n\t\t\t};\n\t\t\tthis.state = {};\n\t\t\tthis.stream = null;\n\t\t\tthis.analyser = null;\n\t\t\tthis.frameId = null;\n\t\n\t\t\tvar me = this;\n\t\t\tlimit.assignSuper(me.state, me.props, config);\n\t\t} //解析器\n\t\n\t\n\t\t_createClass(Audio, [{\n\t\t\tkey: 'start',\n\t\t\tvalue: function start() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (me.analyser) {\n\t\t\t\t\tme.getArrayByAnalyser();\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'stop',\n\t\t\tvalue: function stop() {\n\t\t\t\tvar me = this;\n\t\t\t\tcancelAnimationFrame(me.frameId);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getArrayByAnalyser',\n\t\t\tvalue: function getArrayByAnalyser() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\tvar count = me.analyser.frequencyBinCount;\n\t\t\t\tvar array = new Uint8Array(count);\n\t\t\t\tme.analyser.getByteFrequencyData(array);\n\t\t\t\tstate.changeArray.call(me, array);\n\t\t\t\tme.frameId = requestAnimationFrame(me.getArrayByAnalyser.bind(me));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getAnalyserByStream',\n\t\t\tvalue: function getAnalyserByStream() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar state = me.state;\n\t\t\t\treturn me.getAudioContext().then(function (audioContext) {\n\t\t\t\t\tvar media = audioContext.createMediaStreamSource(me.stream);\n\t\t\t\t\tvar analyser = audioContext.createAnalyser();\n\t\t\t\t\tanalyser.fftSize = state.fftSize;\n\t\t\t\t\tmedia.connect(analyser);\n\t\t\t\t\tme.analyser = analyser;\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getAudioContext',\n\t\t\tvalue: function getAudioContext() {\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\tvar AudioContext = window.AudioContext;\n\t\t\t\t\tif (AudioContext) {\n\t\t\t\t\t\tresolve(new AudioContext());\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject('can not found AudioContext');\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getUserMediaStream',\n\t\t\tvalue: function getUserMediaStream() {\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\tvar NAV = navigator;\n\t\t\t\t\tvar getMedia = NAV.getUserMedia || NAV.webkitGetUserMedia || NAV.mozGetUserMedia || NAV.msGetUserMedia;\n\t\t\t\t\tif (getMedia) {\n\t\t\t\t\t\tgetMedia.call(NAV, { audio: true }, function (stream) {\n\t\t\t\t\t\t\tresolve(stream);\n\t\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\t\treject(e);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject('can not found getMedia');\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getUserMediaArray',\n\t\t\tvalue: function getUserMediaArray() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn me.getUserMediaStream().then(function (stream) {\n\t\t\t\t\tme.stream = stream;\n\t\t\t\t\treturn me.getAnalyserByStream();\n\t\t\t\t}).then(function () {\n\t\t\t\t\tme.getArrayByAnalyser();\n\t\t\t\t}).catch(function (e) {\n\t\t\t\t\tlimit.err(e);\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Audio;\n\t}();\n\t\n\tmodule.exports = Audio;\n\n/***/ }\n\n/******/ });\n\n\n/** WEBPACK FOOTER **\n ** js/bus/html/media/main.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9d698fd7aaeefe6649aa\n **/","module.exports = jQuery;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jQuery\"\n ** module id = 7\n ** module chunks = 2 3 9 11 12 15 17 19 20 25 27 32 33 35 36\n **/","module.exports = limit;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"limit\"\n ** module id = 8\n ** module chunks = 2 3 4 5 6 9 12 13 15 16 17 18 19 20 21 24 25 26 27 28 29 30 31 32 33 34 35 36\n **/","\"use strict\";\n\n// 依赖\nconst $ = require('$');\nconst limit = require('limit');\nconst ViewAudio = require('modules/viewAudio/index');\n\nnew ViewAudio().viewCanvas();\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bus/html/media/main.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\nconst Audio = require('modules/audio/index');\n\nclass viewAudio extends Audio{\n\tprops = {\n\t\telement: null //置入的元素默认是body\n\t\t,width: 200 //宽\n\t\t,height: 40 //高\n\t\t,part: 10 //个数\n\t\t,space: 5 //间隔\n\t\t,radius: 4 //半角\n\t\t,increase: 0 //增强[0~50]\n\t\t,color: '#4d90fe' //颜色\n\t\t,changeArray(arr){\n\t\t\tlet me = this;\n\t\t\tlet state = me.state;\n\t\t\tlet length = arr.length;\n\t\t\tlength = length - length * state.increase / 100;\n\t\t\tlet res = arr.reduce((a, b) => a + b) / length;\n\t\t\tres = limit(res).except(256).multiply(10).toFixed().val();\n\t\t\tme.drawCanvas(res);\n\t\t}\n\t}\n\tcontext = null //画布\n\tcanvas = null //画布节点\n\tconstructor(config){\n\t\tsuper(...arguments);\n\t\tlet me = this\n\t\tlimit.assignSuper(me.state, me.props, config);\n\t\tme.initElement();\n\t}\n\tdestroy(){\n\t\tlet me = this;\n\t\tme.stop();\n\t\tlet div = document.createElement('div');\n\t\tdiv.appendChild(me.canvas);\n\t\tdiv.innerHTML = '';\n\t\tdiv = null;\n\t}\n\tviewCanvas(){\n\t\tlet me = this;\n\t\tme.initCanvas();\n\t\tme.getUserMediaArray();\n\t}\n\tinitElement(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tif( state.element ){\n\t\t\tme.element = state.element;\n\t\t}else{\n\t\t\tme.element = document.body;\n\t\t};\n\t}\n\tinitCanvas(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet canvas = document.createElement('canvas');\n\t\tme.canvas = canvas;\n\t\tme.element.appendChild(canvas);\n\t\tcanvas.width = state.width;\n\t\tcanvas.height = state.height;\n\t\tme.context = canvas.getContext('2d');\n\t}\n\tdrawCanvas(min){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet context = me.context;\n\t\tme.parseData().forEach((val, key) => {\n\t\t\tcontext.fillStyle = '#CCC';\n\t\t\tif( key < min ){\n\t\t\t\tcontext.fillStyle  = state.color;\n\t\t\t};\n\t\t\tme.roundRect.apply(context, [...val, state.radius]);\n\t\t});\n\t}\n\troundRect(x, y, w, h, r){\n\t\tlet context = this;\n\t\tlet max = Math.min(w, h);\n\t\tif( r > max/2 ){\n\t\t\tr = max/2;\n\t\t};\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(x+r, y);\n\t\tcontext.arcTo(x+w, y, x+w, y+h, r);\n\t\tcontext.arcTo(x+w, y+h, x, y+h, r);\n\t\tcontext.arcTo(x, y+h, x, y, r);\n\t\tcontext.arcTo(x, y, x+w, y, r);\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\t}\n\tparseData(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet maxWidth = state.width - state.space * state.part;\n\t\tlet oneMaxWidth = Math.floor( maxWidth / state.part );\n\t\treturn limit.from(new Array(state.part)).map((val, key) => {\n\t\t\tlet top = (oneMaxWidth + state.space) * key;\n\t\t\treturn [top, 0, oneMaxWidth, state.height];\n\t\t});\n\t}\n}\n// 0 20 \nmodule.exports = viewAudio;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/viewAudio/index.js\n **/","\"use strict\";\n\n// 参考 http://www.cnblogs.com/Wayou/p/3543577.html\n// https://mdn.github.io/voice-change-o-matic/\n\n// 依赖\nconst limit = require('limit');\n\nclass Audio{\n\tprops = {\n\t\tfftSize: 128\n\t\t,changeArray: limit.K\n\t}\n\tstate = {}\n\tstream = null //媒体流\n\tanalyser = null //解析器\n\tframeId = null //定时器ID\n\tconstructor(config){\n\t\tlet me = this\n\t\tlimit.assignSuper(me.state, me.props, config);\n\t}\n\tstart(){\n\t\tlet me = this;\n\t\tif( me.analyser ){\n\t\t\tme.getArrayByAnalyser()\n\t\t};\n\t}\n\tstop(){\n\t\tlet me = this;\n\t\tcancelAnimationFrame(me.frameId);\n\t}\n\tgetArrayByAnalyser(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet count = me.analyser.frequencyBinCount;\n\t\tlet array = new Uint8Array(count);\n\t\tme.analyser.getByteFrequencyData(array);\n\t\tstate.changeArray.call(me, array);\n\t\tme.frameId = requestAnimationFrame(me.getArrayByAnalyser.bind(me));\n\t}\n\tgetAnalyserByStream(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\treturn me.getAudioContext().then((audioContext) => {\n\t\t\tlet media = audioContext.createMediaStreamSource(me.stream);\n\t\t\tlet analyser = audioContext.createAnalyser();\n\t\t\tanalyser.fftSize = state.fftSize;\n\t\t\tmedia.connect(analyser);\n\t\t\tme.analyser = analyser;\n\t\t});\n\t}\n\tgetAudioContext(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet AudioContext = window.AudioContext;\n\t\t\tif( AudioContext ){\n\t\t\t\tresolve(new AudioContext());\n\t\t\t}else{\n\t\t\t\treject('can not found AudioContext');\n\t\t\t};\n\t\t});\n\t}\n\tgetUserMediaStream(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet NAV = navigator;\n\t\t\tlet getMedia = NAV.getUserMedia || NAV.webkitGetUserMedia || NAV.mozGetUserMedia || NAV.msGetUserMedia;\n\t\t\tif( getMedia ){\n\t\t\t\tgetMedia.call(NAV, {audio: true}, (stream) => {\n\t\t\t\t\tresolve(stream);\n\t\t\t\t}, (e) => {\n\t\t\t\t\treject(e);\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\treject('can not found getMedia');\n\t\t\t};                \n\t\t});\n\t}\n\tgetUserMediaArray(){\n\t\tlet me = this;\n\t\treturn me.getUserMediaStream().then((stream) => {\n\t\t\tme.stream = stream;\n\t\t\treturn me.getAnalyserByStream();\n\t\t}).then(() => {\n\t\t\tme.getArrayByAnalyser();\n\t\t}).catch((e) => {\n\t\t\tlimit.err(e);\n\t\t});\n\t}\n}\n\nmodule.exports = Audio;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/audio/index.js\n **/"],"sourceRoot":""}