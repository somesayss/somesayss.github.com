{"version":3,"sources":["webpack:///webpack/bootstrap f2cabd4fab19d0158eee?dbe5*********","webpack:///external \"jQuery\"?0cb8******","webpack:///external \"limit\"?1d95*******","webpack:///./src/js/bus/html/media/main.js","webpack:///./src/js/modules/viewAudio/index.js","webpack:///./src/js/modules/audio/index.js"],"names":["$","require","limit","ViewAudio","viewCanvas","Audio","viewAudio","config","arguments","me","assignSuper","state","props","initElement","stop","div","document","createElement","appendChild","canvas","innerHTML","initCanvas","getUserMediaArray","element","body","width","height","context","getContext","min","parseData","forEach","val","key","fillStyle","color","roundRect","apply","radius","x","y","w","h","r","max","Math","beginPath","moveTo","arcTo","closePath","fill","maxWidth","space","part","oneMaxWidth","floor","from","Array","map","top","increase","changeArray","arr","length","res","reduce","a","b","except","multiply","toFixed","drawCanvas","module","exports","fftSize","K","stream","analyser","frameId","getArrayByAnalyser","cancelAnimationFrame","count","frequencyBinCount","array","Uint8Array","getByteFrequencyData","call","requestAnimationFrame","bind","getAudioContext","then","audioContext","media","createMediaStreamSource","createAnalyser","connect","Promise","resolve","reject","AudioContext","window","NAV","navigator","getMedia","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","audio","e","getUserMediaStream","getAnalyserByStream","catch","err"],"mappings":"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","file":"js/bus/html/media/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap f2cabd4fab19d0158eee\n **/","module.exports = jQuery;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jQuery\"\n ** module id = 3\n ** module chunks = 1 2 3 4 5 6 8 10 11 13 14\n **/","module.exports = limit;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"limit\"\n ** module id = 4\n ** module chunks = 1 2 3 4 6 7 8 9 10 11 12 13 14 15\n **/","\"use strict\";\n\n// 依赖\nconst $ = require('$');\nconst limit = require('limit');\nconst ViewAudio = require('modules/viewAudio/index');\n\nnew ViewAudio().viewCanvas();\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bus/html/media/main.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\nconst Audio = require('modules/audio/index');\n\nclass viewAudio extends Audio{\n\tprops = {\n\t\telement: null //置入的元素默认是body\n\t\t,width: 200 //宽\n\t\t,height: 40 //高\n\t\t,part: 10 //个数\n\t\t,space: 5 //间隔\n\t\t,radius: 4 //半角\n\t\t,increase: 0 //增强[0~50]\n\t\t,color: '#4d90fe' //颜色\n\t\t,changeArray(arr){\n\t\t\tlet me = this;\n\t\t\tlet state = me.state;\n\t\t\tlet length = arr.length;\n\t\t\tlength = length - length * state.increase / 100;\n\t\t\tlet res = arr.reduce((a, b) => a + b) / length;\n\t\t\tres = limit(res).except(256).multiply(10).toFixed().val();\n\t\t\tme.drawCanvas(res);\n\t\t}\n\t}\n\tcontext = null //画布\n\tcanvas = null //画布节点\n\tconstructor(config){\n\t\tsuper(...arguments);\n\t\tlet me = this\n\t\tlimit.assignSuper(me.state, me.props, config);\n\t\tme.initElement();\n\t}\n\tdestroy(){\n\t\tlet me = this;\n\t\tme.stop();\n\t\tlet div = document.createElement('div');\n\t\tdiv.appendChild(me.canvas);\n\t\tdiv.innerHTML = '';\n\t\tdiv = null;\n\t}\n\tviewCanvas(){\n\t\tlet me = this;\n\t\tme.initCanvas();\n\t\tme.getUserMediaArray();\n\t}\n\tinitElement(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tif( state.element ){\n\t\t\tme.element = state.element;\n\t\t}else{\n\t\t\tme.element = document.body;\n\t\t};\n\t}\n\tinitCanvas(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet canvas = document.createElement('canvas');\n\t\tme.canvas = canvas;\n\t\tme.element.appendChild(canvas);\n\t\tcanvas.width = state.width;\n\t\tcanvas.height = state.height;\n\t\tme.context = canvas.getContext('2d');\n\t}\n\tdrawCanvas(min){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet context = me.context;\n\t\tme.parseData().forEach((val, key) => {\n\t\t\tcontext.fillStyle = '#CCC';\n\t\t\tif( key < min ){\n\t\t\t\tcontext.fillStyle  = state.color;\n\t\t\t};\n\t\t\tme.roundRect.apply(context, [...val, state.radius]);\n\t\t});\n\t}\n\troundRect(x, y, w, h, r){\n\t\tlet context = this;\n\t\tlet max = Math.min(w, h);\n\t\tif( r > max/2 ){\n\t\t\tr = max/2;\n\t\t};\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(x+r, y);\n\t\tcontext.arcTo(x+w, y, x+w, y+h, r);\n\t\tcontext.arcTo(x+w, y+h, x, y+h, r);\n\t\tcontext.arcTo(x, y+h, x, y, r);\n\t\tcontext.arcTo(x, y, x+w, y, r);\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\t}\n\tparseData(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet maxWidth = state.width - state.space * state.part;\n\t\tlet oneMaxWidth = Math.floor( maxWidth / state.part );\n\t\treturn limit.from(new Array(state.part)).map((val, key) => {\n\t\t\tlet top = (oneMaxWidth + state.space) * key;\n\t\t\treturn [top, 0, oneMaxWidth, state.height];\n\t\t});\n\t}\n}\n// 0 20 \nmodule.exports = viewAudio;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/viewAudio/index.js\n **/","\"use strict\";\n\n// 参考 http://www.cnblogs.com/Wayou/p/3543577.html\n// https://mdn.github.io/voice-change-o-matic/\n\n// 依赖\nconst limit = require('limit');\n\nclass Audio{\n\tprops = {\n\t\tfftSize: 128\n\t\t,changeArray: limit.K\n\t}\n\tstate = {}\n\tstream = null //媒体流\n\tanalyser = null //解析器\n\tframeId = null //定时器ID\n\tconstructor(config){\n\t\tlet me = this\n\t\tlimit.assignSuper(me.state, me.props, config);\n\t}\n\tstart(){\n\t\tlet me = this;\n\t\tif( me.analyser ){\n\t\t\tme.getArrayByAnalyser()\n\t\t};\n\t}\n\tstop(){\n\t\tlet me = this;\n\t\tcancelAnimationFrame(me.frameId);\n\t}\n\tgetArrayByAnalyser(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet count = me.analyser.frequencyBinCount;\n\t\tlet array = new Uint8Array(count);\n\t\tme.analyser.getByteFrequencyData(array);\n\t\tstate.changeArray.call(me, array);\n\t\tme.frameId = requestAnimationFrame(me.getArrayByAnalyser.bind(me));\n\t}\n\tgetAnalyserByStream(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\treturn me.getAudioContext().then((audioContext) => {\n\t\t\tlet media = audioContext.createMediaStreamSource(me.stream);\n\t\t\tlet analyser = audioContext.createAnalyser();\n\t\t\tanalyser.fftSize = state.fftSize;\n\t\t\tmedia.connect(analyser);\n\t\t\tme.analyser = analyser;\n\t\t});\n\t}\n\tgetAudioContext(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet AudioContext = window.AudioContext;\n\t\t\tif( AudioContext ){\n\t\t\t\tresolve(new AudioContext());\n\t\t\t}else{\n\t\t\t\treject('can not found AudioContext');\n\t\t\t};\n\t\t});\n\t}\n\tgetUserMediaStream(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet NAV = navigator;\n\t\t\tlet getMedia = NAV.getUserMedia || NAV.webkitGetUserMedia || NAV.mozGetUserMedia || NAV.msGetUserMedia;\n\t\t\tif( getMedia ){\n\t\t\t\tgetMedia.call(NAV, {audio: true}, (stream) => {\n\t\t\t\t\tresolve(stream);\n\t\t\t\t}, (e) => {\n\t\t\t\t\treject(e);\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\treject('can not found getMedia');\n\t\t\t};                \n\t\t});\n\t}\n\tgetUserMediaArray(){\n\t\tlet me = this;\n\t\treturn me.getUserMediaStream().then((stream) => {\n\t\t\tme.stream = stream;\n\t\t\treturn me.getAnalyserByStream();\n\t\t}).then(() => {\n\t\t\tme.getArrayByAnalyser();\n\t\t}).catch((e) => {\n\t\t\tlimit.err(e);\n\t\t});\n\t}\n}\n\nmodule.exports = Audio;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/audio/index.js\n **/"],"sourceRoot":""}