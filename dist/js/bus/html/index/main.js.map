{"version":3,"sources":["webpack:///webpack/bootstrap efc2fd45d5010312c680?47a8**","webpack:///external \"jQuery\"?0cb8*","webpack:///external \"limit\"?1d95*","webpack:///./src/js/bus/html/index/main.js","webpack:///./src/js/modules/upload/index.js","webpack:///./src/js/modules/parseForm/index.js"],"names":["$","require","limit","Upload","on","element","document","getElementById","onprogress","e","log","submit","then","err","ParseForm","config","arguments","props","a","url","K","errParseEle","errSys","me","assign","state","window","FormData","XMLHttpRequest","ajaxSubmit","iframeSubmit","Promise","resolve","reject","AJAX","open","upload","loaded","total","toFixed","toNumber","val","onload","parseRespone","target","responseText","onerror","send","useFormData","iframe","createElement","name","getUid","style","display","body","appendChild","iframeBody","contentWindow","innerHTML","replace","removeHideArea","errMeg","response","JSON","parse","getValueInObject","content","div","module","exports","isFormElement","nodeName"],"mappings":"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","file":"js/bus/html/index/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap efc2fd45d5010312c680\n **/","module.exports = jQuery;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jQuery\"\n ** module id = 3\n ** module chunks = 1 2 3 4 5 6 8 10 11 13 14\n **/","module.exports = limit;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"limit\"\n ** module id = 4\n ** module chunks = 1 2 3 4 6 7 8 9 10 11 12 13 14 15\n **/","\"use strict\";\n\n// 依赖\nconst $ = require('$');\nconst limit = require('limit');\nconst Upload = require('modules/upload/index');\n\n$('#fileUpload').on('click', () => {\n\tnew Upload({\n\t\telement: document.getElementById('form'),\n\t\tonprogress(e){\n\t\t\tlimit.log( limit['*'](e, 100) + '%');\n\t\t}\n\t}).submit().then((e) => {\n\t\tlimit.log(e);\n\t}, (e) => {\n\t\tlimit.err(e);\n\t});\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bus/html/index/main.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\nconst ParseForm = require('modules/parseForm/index');\n\nclass Upload extends ParseForm {\n\tprops = {\n\t\ta: 'a1'\n\t\t,url: '/common/upload.json'\n\t\t,onprogress: limit.K\n\t\t,errParseEle: '上传失败，未解析到element。'\n\t\t,errSys: '上传失败，系统错误。'\n\t}\n\tconstructor(config){\n\t\tsuper(...arguments);\n\t\tlet me = this;\n\t\tlimit.assign(me.state, me.props, config);\n\t}\n\tsubmit(){\n\t\tlet me = this;\n\t\tif( window.FormData && window.XMLHttpRequest ){\n\t\t\treturn me.ajaxSubmit();\n\t\t}else{\n\t\t\treturn me.iframeSubmit();\n\t\t};\n\t}\n\tajaxSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif( !me.element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet state = me.state;\n\t\t\tlet AJAX = new XMLHttpRequest();\n\t\t\tAJAX.open('POST', state.url);\n\t\t\t// 上传进度\n\t\t\tAJAX.upload.onprogress = function(e){\n\t\t\t\tlet loaded = e.loaded;\n\t\t\t\tlet total = e.total;\n\t\t\t\tstate.onprogress( limit(loaded/total).toFixed(2).toNumber().val(), loaded, total );\n\t\t\t};\n\t\t\t// 结束\n\t\t\tAJAX.onload = function(e){\n\t\t\t\tme.parseRespone(e.target.responseText, resolve, reject);\n\t\t\t};\n\t\t\t// 错误\n\t\t\tAJAX.onerror = reject;\n\t\t\tAJAX.send( me.useFormData() );\n\t\t});\n\t}\n\tiframeSubmit(){\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet element = me.element;\n\t\t\tif( !element ){\n\t\t\t\treturn reject(me.state.errParseEle);\n\t\t\t};\n\t\t\tlet iframe = document.createElement('iframe');\n\t\t\telement.target = iframe.name = `upload${limit.getUid()}`;\n\t\t\tiframe.style.display = 'none';\n\t\t\tdocument.body.appendChild(iframe);\n\t\t\tiframe.onload = function(){\n\t\t\t\tiframe.onload = null;\n\t\t\t\tlet iframeBody = iframe.contentWindow.document.body;\n\t\t\t\tlet responseText = iframeBody.innerHTML.replace(/<.*?>/g, '');\n\t\t\t\tme.parseRespone(responseText, resolve, reject);\n\t\t\t\tme.removeHideArea(iframe);\n\t\t\t\telement.target = '';\n\t\t\t};\n\t\t\telement.submit();\n\t\t});\n\t}\n\tparseRespone(responseText, resolve, reject){\n\t\tlet me = this;\n\t\tlet errMeg = me.state.errSys;\n\t\tif( responseText ){\n\t\t\ttry{\n\t\t\t\tlet response = JSON.parse(responseText);\n\t\t\t\tif( limit.getValueInObject(response, 'hasError') === false ){\n\t\t\t\t\tif( limit.getValueInObject(response, 'content', 'isSuccess') ){\n\t\t\t\t\t\tresolve(response.content);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject( limit.getValueInObject(response, 'content', 'msg') || errMeg );\n\t\t\t\t\t};\n\t\t\t\t}else{\n\t\t\t\t\treject( limit.getValueInObject(response, 'msg') || errMeg );\n\t\t\t\t};\n\t\t\t}catch(e){\n\t\t\t\treject(e);\n\t\t\t};\n\t\t}else{\n\t\t\treject(errMeg);\n\t\t};\n\t}\n\tremoveHideArea(element){\n\t\tlet me = this;\n\t\tlet div = document.createElement('div');\n\t\tdiv.appendChild(element);\n\t\tdiv.innerHTML = '';\n\t\tdiv = null;\n\t}\n}\n\nmodule.exports = Upload;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/upload/index.js\n **/","\"use strict\";\n\n// 依赖\nconst limit = require('limit');\n\nclass ParseForm {\n\tprops = {\n\t\telement: null\t// 主要表单\n\t}\n\tstate = {}\n\telement = null\n\tconstructor(config){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlimit.assign(state, me.props, config);\n\t\tif( me.isFormElement() ){\n\t\t\tme.element = state.element;\n\t\t};\n\t}\n\tisFormElement(){\n\t\tlet me = this;\n\t\tlet state = me.state;\n\t\tlet element = state.element;\n\t\treturn element && element.nodeName === 'FORM';\n\t}\n\tuseFormData(){\n\t\tlet me = this;\n\t\tlet element = me.element;\n\t\tif( element && window.FormData ){\n\t\t\treturn new FormData(element);\n\t\t};\n\t}\n}\n\nmodule.exports = ParseForm;\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/modules/parseForm/index.js\n **/"],"sourceRoot":""}